!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("solid-js"),require("solid-js/store"),require("xstate"),require("solid-js/web")):"function"==typeof define&&define.amd?define(["exports","solid-js","solid-js/store","xstate","solid-js/web"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).XStateSolid={},t.Solid,t.SolidStore,t.XState,t.web)}(this,(function(t,e,n,r,o){"use strict";var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function c(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}var u=function(t){return function(t){return"object"==typeof t&&"value"in t&&"context"in t&&"event"in t&&"_event"in t&&"can"in t&&"matches"in t}(t)?i(i({},t),{toJSON:t.toJSON,toStrings:t.toStrings,can:t.can,hasTag:t.hasTag,matches:t.matches}):t};function l(t){var e;return null!=t&&"object"==typeof t&&(!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}var f=function(t,e){if(!l(t))return t;var n=!Array.isArray(t),r=s(n?[{},Object.keys(t)]:[[],t],2),o=r[0],i=r[1];e.set(t,o);for(var a=0;a<i.length;++a){var c=n?i[a]:a,u=t[c];e.has(u)?o[c]=e.get(u):o[c]=f(u,e)}return o};function p(t){var r=s(n.createStore(f(t,new WeakMap)),2),o=r[0],i=r[1],a=t;return[o,function(t){e.batch((function(){!function(t,e,n,r){var o=new WeakMap,i=function(t,e,a){if(e!==t)if(o.has(t))n.apply(void 0,c(c([],s(a),!1),[o.get(t)],!1));else if(l(t)&&l(e))if(o.set(t,function(t,e){void 0===e&&(e={});for(var n=e,r=0;r<t.length;r++)n=null==n?void 0:n[t[r]];return n}(a,r)),Array.isArray(t)&&Array.isArray(e)){for(var u=t.length-e.length,f=Math.min(e.length,t.length),p=Math.max(t.length,e.length),v=0,y=f-1;v<y;v++,y--)i(t[v],e[v],c(c([],s(a),!1),[v],!1)),i(t[y],e[y],c(c([],s(a),!1),[y],!1));if(0!==u){for(var d=f;d<=p-1;d++)n.apply(void 0,c(c([],s(a),!1),[d,t[d]],!1));e.length>t.length&&n.apply(void 0,c(c([],s(a),!1),["length",t.length],!1))}}else{for(var h=Object.keys(t),g=0,b=h.length;g<b;g++)i(t[h[g]],e[h[g]],c(c([],s(a),!1),[h[g]],!1));var S=Object.keys(e);for(g=0,b=S.length;g<b;g++)void 0===t[S[g]]&&n.apply(void 0,c(c([],s(a),!1),[S[g],void 0],!1))}else"toString"!==a[a.length-1]&&n.apply(void 0,c(c([],s(a),!1),[function(){return t}],!1))};i(t,e,[])}(t,a,i,o)})),a=t}]}var v=function(){};function y(t){for(var n=[],c=1;c<arguments.length;c++)n[c-1]=arguments[c];var u=s(n,1),l=u[0],f=void 0===l?{}:l,p=f.context,v=f.guards,y=f.actions,d=f.activities,h=f.services,g=f.delays,b=f.state,S=a(f,["context","guards","actions","activities","services","delays","state"]),j={guards:v,actions:y,activities:d,services:h,delays:g},O=t.withConfig(j,(function(){return i(i({},t.context),p)})),m=r.interpret(O,S);return o.isServer||(m.start(b?r.State.create(b):void 0),e.onCleanup((function(){return m.stop()}))),m}t.createService=y,t.useActor=function(t){var n=e.createMemo((function(){return"function"==typeof t?t():t})),r=function(){var t,e;return null===(e=(t=n()).getSnapshot)||void 0===e?void 0:e.call(t)},o=s(p({snapshot:u(r())}),2),i=o[0],a=o[1],c=function(t){a({snapshot:u(t)})};return e.createEffect((function(t){t||c(r());var o=n().subscribe({next:c,error:v,complete:v}).unsubscribe;return e.onCleanup(o),!1}),!0),[function(){return i.snapshot},function(t){return n().send(t)}]},t.useMachine=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=s(n,1),a=i[0],c=void 0===a?{}:a,l=y(t,c),f=function(){return l.status===r.InterpreterStatus.NotStarted?c.state?r.State.create(c.state):l.machine.initialState:l.getSnapshot()},v=s(p(u(f())),2),d=v[0],h=v[1];return e.onMount((function(){var t=l.subscribe((function(t){h(u(t))})).unsubscribe;e.onCleanup(t)})),[d,l.send,l]},Object.defineProperty(t,"__esModule",{value:!0})}));
