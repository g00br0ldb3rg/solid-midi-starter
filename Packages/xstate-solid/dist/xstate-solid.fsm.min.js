!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@xstate/fsm"),require("solid-js"),require("solid-js/store"),require("solid-js/web")):"function"==typeof define&&define.amd?define(["exports","@xstate/fsm","solid-js","solid-js/store","solid-js/web"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).XStateSolidFSM={},e.XStateFSM,e.Solid,e.SolidStore,e.web)}(this,(function(e,t,r,n,o){"use strict";var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function l(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function f(e){var t;return null!=e&&"object"==typeof e&&(!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}var u=function(e,t){if(!f(e))return e;var r=!Array.isArray(e),n=a(r?[{},Object.keys(e)]:[[],e],2),o=n[0],i=n[1];t.set(e,o);for(var l=0;l<i.length;++l){var s=r?i[l]:l,c=e[s];t.has(c)?o[s]=t.get(c):o[s]=u(c,t)}return o};function s(e){var t=a(n.createStore(u(e,new WeakMap)),2),o=t[0],i=t[1],s=e;return[o,function(e){r.batch((function(){!function(e,t,r,n){var o=new WeakMap,i=function(e,t,u){if(t!==e)if(o.has(e))r.apply(void 0,l(l([],a(u),!1),[o.get(e)],!1));else if(f(e)&&f(t))if(o.set(e,function(e,t){void 0===t&&(t={});for(var r=t,n=0;n<e.length;n++)r=null==r?void 0:r[e[n]];return r}(u,n)),Array.isArray(e)&&Array.isArray(t)){for(var s=e.length-t.length,c=Math.min(t.length,e.length),p=Math.max(e.length,t.length),y=0,h=c-1;y<h;y++,h--)i(e[y],t[y],l(l([],a(u),!1),[y],!1)),i(e[h],t[h],l(l([],a(u),!1),[h],!1));if(0!==s){for(var v=c;v<=p-1;v++)r.apply(void 0,l(l([],a(u),!1),[v,e[v]],!1));t.length>e.length&&r.apply(void 0,l(l([],a(u),!1),["length",e.length],!1))}}else{for(var d=Object.keys(e),g=0,b=d.length;g<b;g++)i(e[d[g]],t[d[g]],l(l([],a(u),!1),[d[g]],!1));var j=Object.keys(t);for(g=0,b=j.length;g<b;g++)void 0===e[j[g]]&&r.apply(void 0,l(l([],a(u),!1),[j[g],void 0],!1))}else"toString"!==u[u.length-1]&&r.apply(void 0,l(l([],a(u),!1),[function(){return e}],!1))};i(e,t,[])}(e,s,i,o)})),s=e}]}function c(e){var t=r.createMemo((function(){return"function"==typeof e?e():e})),n=a(s(p(t().state)),2),o=n[0],i=n[1];r.createEffect((function(){var e=t(),n=e.subscribe((function(){return i(p(e.state))})).unsubscribe;r.onCleanup(n)}));return[o,function(e){return t().send(e)},t()]}function p(e){return i(i({},e),{matches:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.value,e.matches(t[0])}})}e.useMachine=function(e,n){var i=t.createMachine(e.config,n||e._options),a=t.interpret(i);return o.isServer||(a.start(),r.onCleanup((function(){return a.stop()}))),c(a)},e.useService=c,Object.defineProperty(e,"__esModule",{value:!0})}));
